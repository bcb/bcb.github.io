---
layout: post
title: "Create an ECR image repository"
date: 2016-07-14 00:54:00 +10:00
categories: aws
---

# Login to the ECR registry

Docker must be logged into the registry. The aws client can output the required
docker command to login with (`get-login`). Note that not all AWS regions
support ECR. Therefore you should specify the region of the registry whenever
using `aws ecr` (if it isn't the default region in your aws cli configuration).

```bash
$ aws ecr --region us-west-2 get-login |xclip
```

Paste the output and press enter to login.

# Create repository

```bash
$ aws ecr --region us-west-2 create-repository --repository-name my-team/web-app
```

# Push an image

First tag it:

```bash
$ docker tag myimage aws_account_id.dkr.ecr.us-west-2.amazonaws.com/my-team/web-app
```

Then push:

```bash
$ docker push aws_account_id.dkr.ecr.us-west-2.amazonaws.com/my-team/web-app
```

# Delete an image
```bash
aws ecr --region us-west-2 batch-delete-image --repository-name my-team/web-app --image-ids imageTag=latest
```

# Delete repository

```bash
aws ecr --region us-west-2 delete-repository --repository-name my-team/web-app
```

# List images
```bash
aws ecr --region us-west-2 list-images --repository-name my-team/web-app
```
